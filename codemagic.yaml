workflows:
  # ===================================
  # iOS Workflow - Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ğ´Ğ»Ñ iPhone
  # ===================================
  ios-release:
    name: iOS Release
    max_build_duration: 120
    instance_type: mac_mini_m1
    
    environment:
      vars:
        # ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
        FLUTTER_VERSION: 3.24.0
        XCODE_WORKSPACE: "Runner.xcworkspace"
        XCODE_SCHEME: "Runner"
      
      flutter: stable
      xcode: latest
      cocoapods: default
    
    scripts:
      - name: ğŸ“¦ Get Flutter packages
        script: |
          flutter pub get
      
      - name: ğŸ”§ Generate iOS build files
        script: |
          flutter precache --ios
          flutter build ios-framework --no-codesign
      
      - name: ğŸ Install CocoaPods dependencies
        script: |
          cd ios && pod install
      
      - name: ğŸ—ï¸ Build iOS release (without signing)
        script: |
          flutter build ios --release --no-codesign
    
    artifacts:
      - build/ios/Release-iphoneos/*.app
      - /tmp/xcodebuild_logs/*.log
    
    publishing:
      email:
        recipients:
          - kazban0v.beybit@gmail.com
        notify:
          success: true
          failure: true

  # ===================================
  # Android Workflow - Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ğ´Ğ»Ñ Android
  # ===================================
  android-release:
    name: Android Release
    max_build_duration: 60
    instance_type: linux_x2
    
    environment:
      vars:
        FLUTTER_VERSION: 3.24.0
      
      flutter: stable
    
    scripts:
      - name: ğŸ“¦ Get Flutter packages
        script: |
          flutter packages pub get
      
      - name: ğŸ¤– Build Android APK
        script: |
          flutter build apk --release
      
      - name: ğŸ¤– Build Android App Bundle
        script: |
          flutter build appbundle --release
    
    artifacts:
      - build/app/outputs/**/*.apk
      - build/app/outputs/**/*.aab
    
    publishing:
      email:
        recipients:
          - kazban0v.beybit@gmail.com
        notify:
          success: true
          failure: true

  # ===================================
  # Development Workflow - Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğµ Ñ‚ĞµÑÑ‚Ñ‹
  # ===================================
  development:
    name: Development Build
    max_build_duration: 30
    instance_type: linux_x2
    
    triggering:
      events:
        - push
      branch_patterns:
        - pattern: 'develop'
          include: true
          source: true
    
    environment:
      flutter: stable
    
    scripts:
      - name: ğŸ“¦ Get packages
        script: flutter packages pub get
      
      - name: ğŸ§ª Run tests
        script: flutter test
        ignore_failure: true
      
      - name: ğŸ” Analyze code
        script: flutter analyze
        ignore_failure: true
      
      - name: ğŸ¤– Build Android APK (Debug)
        script: flutter build apk --debug
    
    artifacts:
      - build/app/outputs/**/*.apk
    
    publishing:
      email:
        recipients:
          - kazban0v.beybit@gmail.com
        notify:
          success: false
          failure: true

